## 摘要

经过多方参考, 决定了该模块的工作方式, 本文将对该模块的
设计思路和原则等各方面进行详细说明, 包括边缘处理、技术考量、实现细节等

## 核心原则

**单线Fiber独立性**

- 每个异步操作都是独立于 EventLoop 的单线 Fiber
- 对 Fiber 的操作必须考虑 EventLoop 的协程空间
- 任何挂起/恢复操作都应该对当前操作的 Fiber 负责

### 边缘处理

> 该模块的设计思路符合大多数异步模型的设计思路,
> 尽可能保持简单和易用, 减少用户的负担

### 协程错误处理

- 所有异常都会被限制在其协程内, 不会影响其他协程
- 在其他上下文尝试获取异常协程的结果时, 会抛出异常

### 事件系统详细设计

- 事件创建: 事件对象创建后不可修改
- 事件运行: 事件进入队列,而非立即执行
- 事件异常: 所有事件都会被执行, 无法通过异常阻止后续事件
- 事件上下文: 在独立协程中执行
- 事件完成: 处理完成后自动清理, 无需关心事件的清理
- 事件顺序: 按照入栈顺序执行

### 参考资料

- `PHP` Fibers RFC
- `Go` 并发模式
- `JavaScript` 异步模型
- `revolt/event-loop` 文档
